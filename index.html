<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index,follow">
    <title>Proyecto OIT</title>
    <link rel="icon" href="IMG/logo_oit_pestaña.jpg">
    <!-- Añadir el archivo CSS -->
    <link rel="stylesheet" href="css/OIT.css">  
    <!-- Añadir el CDN de Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin=""/>
    <!-- Añadir CDN de JS -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
   
    <!-- Añadir libreria para opacidad de las capas -->
    <link rel="stylesheet" href="dist/L.Control.HtmlLegend.css" />
    <!-- Control de leyendas -->
    <script src="dist/L.Control.HtmlLegend.js"></script>
    <!-- incorporar rayas a los poligonos -->
    <script src="js/leaflet-polygon.fillPattern.js"></script>

    <!-- Añadir control de paneles y estilo -->
    <script src="js/leaflet-panel-layers.js"></script>
    <link rel="stylesheet" href="css/leaflet-panel-layers.css"/>
    <script>
        var controlCapas;
        $(document).ready(function () {
        // Agregar Google Hibrido como mapa base
        var osmLayer =  L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}',{
            maxZoom: 18,
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            subdomains:['mt0','mt1','mt2','mt3']
        });
        //Agregar Open Street Map como mapa base
        var OSM = new L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
        });
        
        // Fnción que hace zoom a cada evento al hacer click con el cursor
        function zoomToFeature(e) {
            map.fitBounds(e.target.getBounds());
        }
        // Función para generar un cartel al posarce sobre el departamento
        function popUpfondo (feature, layer) {
            if (feature.properties && feature.properties.nam) {
                layer.bindTooltip("<b>" + feature.properties.nam + "</b>", {
                    interactive: true,
                    permanent: false,
                    fillopacity: 0.01,
                    direction: 'top',
                    className: 'popup',
                });
                layer.on({      
                    click: zoomToFeature
                });
            }
            
        }
        // Capa de fondo de departamentos
        var capa_fondo = L.geoJson(Algodon_19_20, {
            fillOpacity:0,
            color:'indigo',
            weight: 2,
            onEachFeature: popUpfondo,
        })
        
        // Generar Función de colores para RTI
        function getColor(d) {
            return d == 1 ? '#fefefc' :
                   d == 2 ? '#00cfff' :
                   d == 3 ? '#2b83ba' :
                   '';
            
        }
        
        //Modificar el color de fonde en función de la propiedad Riesgo de trabajo infantil
        function style1(feature) {
            return {
                fillColor: getColor(feature.properties.RTI),
                weight: 1,
                opacity: 0.5,
                color: 'white',
                dashArray: '3',
            };
        }
        
        // Función para generar un cartel al posarce sobre el departamento
        function popUpInfo (feature, layer) {
            if (feature.properties && feature.properties.nam) {
                layer.bindTooltip("<b>" + feature.properties.nam + "</b>"+
                "<br> RTI: "+ feature.properties.RTI, {
                    interactive: true,
                    permanent: false,
                    fillopacity: 0.01,
                    direction: 'top',
                    className: 'popup',
                });
                layer.on({      
                    click: zoomToFeature
                });
            }
            
        }
        
        var datos_mirti = L.geoJson(Datos_MIRTI_act, {
            style: style1,
            onEachFeature: popUpInfo,
        });
        // ================= AÑADIR ÁREA SEMBRADA DE ALGODÓN EN DIFERENTES AÑOS====================================
        // Función para generar un cartel al posarce sobre el departamento
        function popUpInfoAlgodon (feature, layer) {
            if (feature.properties && feature.properties.nam) {
                layer.bindTooltip("<b>" + feature.properties.nam + "</b>"+
                "<br> Área Sembrada: "+ feature.properties.Area_Sem, {
                    interactive: true,
                    permanent: false,
                    fillopacity: 0.01,
                    direction: 'top',
                    className: 'popup',
                });
                layer.on({
                    click: zoomToFeature
                });
            }
        }
        // Generar Función de colores para RTI
        function getColorAlgodon(d) {
            return d > 21021 ? '#672202' :
                   d > 11017 ? '#de001d' :
                   d > 6464  ? '#fc0800' :
                   d > 2500  ? '#f6755e' :
                   d > 0     ? '#f8c5c0' :
                   '#ffffff';
            
        }  
        
        //Modificar el color de fonde en función de la propiedad Riesgo de trabajo infantil
        function styleAlgodon(feature) {
            return {
                fillColor: getColorAlgodon(feature.properties.Area_Sem),
                weight: 1,
                opacity: 0.5,
                color: 'white',
                dashArray: '3',
                fillOpacity: 1
            };
        }
        //Añadir icono a cada desmotadora
        var redMarker = L.icon({
            color :'red',
            iconUrl:'IMG/algodonPNG.png',
            iconSize:[35,35]
        })
        // ================= AÑADIR Nombre de las desmotadoras====================================
        // Función para generar un cartel al posarce sobre el departamento
        function popUpInfoDes (feature, layer) {
            if (feature.properties && feature.properties.Nombre) {
                layer.bindTooltip("<b>" + feature.properties.Nombre + "</b>", {
                    interactive: true,
                    permanent: false,
                    fillopacity: 0.01,
                    direction: 'top',
                    className: 'popup',
                });
                layer.setIcon(redMarker, {opacity:0.01})
            }
        }
        
        //Añadir la capa de desmotadoras 2021-2022
        var desmotadoras = L.geoJson(Desmotadoras, {
            onEachFeature: popUpInfoDes
        });
        
       
        // añadir área sembrada de Algodón 2019-2020 al mapa
        var algodon_19_20 = L.geoJson(Algodon_19_20, {
            style: styleAlgodon,
            onEachFeature: popUpInfoAlgodon,
        });
        // Generar Función de colores para RTI
        function getColorperfPro(d) {
            return d > 4 ? '#672202' :
                   d > 3 ? '#de001d' :
                   d > 2  ? '#fc0800' :
                   d > 1  ? '#f6755e' :
                   d > 0     ? '#f8c5c0' :
                   '#ffffff';
            
        }  
        
        //Modificar el color de fonde en función de la propiedad Riesgo de trabajo infantil
        function styleperfPro(feature) {
            return {
                fillColor: getColorperfPro(feature.properties.id),
                weight: 1,
                opacity: 0.5,
                color: 'white',
                dashArray: '3',
                fillOpacity: 1
            };
        }

        // añadir los perfiles de productores al mapa
        var perfilProductores = L.geoJson(perfilProductor, {
            style: styleperfPro,
            onEachFeature: popUpInfoAlgodon,
        });
        
        var map = L.map('map',{
            center: [-29.25,-61.43],
            zoom: 6,
            layers: [osmLayer,capa_fondo]
        });
        
        // Hacer un diccionario con los mapa base que podemos usar
        var baseMaps = [{
            group:"Mapa base",
            layers:[{
                name: "Google HYBRID",
                layer: osmLayer},
                {name:"Open Street Map",
                layer: OSM}
            ]
        }];
        // Unir las capas que pretendemos controlar mediante la función L.control.layers()
        var capas = [{
            group:"Capas del Proyecto",
            layers:[{
            name:'Departamentos', 
            layer: capa_fondo},
            {name:'Datos MIRTI',
            layer: datos_mirti},
            {name:'Algodón 19-20',
            layer: algodon_19_20},
            {name: 'Desmotadoras',
            layer: desmotadoras}
            ]
        }];
        base = {
            "Google HYBRID":osmLayer,
            "Open Street Map": OSM
                }
        capa = {
            "Departamentos": capa_fondo,
            "Datos MIRTI":datos_mirti,
            "Área sembrada de Algodón":algodon_19_20,
            "Desmotadoras":desmotadoras,
            "Perfil de Productores": perfilProductores

        }
        
        // controlCapas = L.control.panelLayers(baseMaps, capas,
        //         {
        //           compact: true,
        //           // collapsed: true,	
        //           collapsibleGroups: true
        //         }).addTo(map);
        L.control.layers(base,capa,{}).addTo(map);
            // Añadimos el control de opacidad de las capas
        var layer1 = L.control.htmllegend({
              position: 'bottomright',
              legends: [{
                name: 'Datos Mirti',
                layer: datos_mirti,
                elements: [{
                    label: 'Alto Riesgo',
                    html: '',
                    style: {
                        'background-color': 'darkBlue',
                        'width': '10px',
                        'height': '10px'
                    }
                }, {
                    label: 'Medio Riesgo',
                    html: '',
                    style: {
                        'background-color': 'lightblue',
                        'width': '10px',
                        'height': '10px'
                    }
                },{
                    label: 'Bajo Riesgo',
                    html: '',
                    style: {
                        'background-color': 'white',
                        'width': '10px',
                        'height': '10px'
                    }
                }
            ]
             }],
             collapseSimple: true,
             detectStretched: true,
             collapsedOnInit: true,
             defaultOpacity: 0.7,
             visibleIcon: 'icon icon-eye',
             hiddenIcon: 'icon icon-eye-slash',
             updateOpacity: function (layer, opacity) {
                    layer.setStyle({fillOpacity: opacity })
                }
        })
        map.addControl(layer1)
        
              // Añadimos el control de opacidad de las capas producción de algodón
        var layer2 = L.control.htmllegend({
              position: 'bottomright',
              legends: [{
                name: 'Datos Mirti',
                layer: algodon_19_20,
                elements: [{
                    label: 'Alto Riesgo',
                    html: '',
                    style: {
                        'background-color': 'darkBlue',
                        'width': '10px',
                        'height': '10px'
                    }
                }, {
                    label: 'Medio Riesgo',
                    html: '',
                    style: {
                        'background-color': 'lightblue',
                        'width': '10px',
                        'height': '10px'
                    }
                },{
                    label: 'Bajo Riesgo',
                    html: '',
                    style: {
                        'background-color': 'white',
                        'width': '10px',
                        'height': '10px'
                    }
                }
            ]
             }],
             collapseSimple: true,
             detectStretched: true,
             collapsedOnInit: true,
             defaultOpacity: 0.7,
             visibleIcon: 'icon icon-eye',
             hiddenIcon: 'icon icon-eye-slash',
             updateOpacity: function (layer, opacity) {
                    layer.setStyle({fillOpacity: opacity , defaultOpacity:opacity})
                }
        })
        map.addControl(layer2)
        
        
        var DeleteControl  = L.Control.extend({
              options: {
                position: 'topright'
              },
           
              })
        map.addControl(new DeleteControl())
        });
        
    </script>
</head>
<body>
     <!-- añadir archivo datos MIRTI Actualizados-->
     <script src="js/Datos_MIRTI_3_Provincias_Act.js"></script>
     <!-- añadir archivo de perfiles de productores -->
     <script src="js/Perfil_de_productor.js"></script>
     <!-- añadir archivo área sembrada de Algodón 2019-2020 -->
     <script src="js/Area Algodon_19_20.js"></script>
    <!-- Añadir el GeoJson de desmotadoras -->
    <script src="js/Desmotadoras.js"></script>
    <div class="inicio">
        <img class="logoInicio" src="IMG/algodonPNG.png" alt="">
    </div>
     <div class="contenedor-principal">
        <div class="Titulo">SIG Cadena de Algodón en Argentina</div>
        <a  class="OIT" href="https://www.ilo.org/global/lang--es/index.htm">
            <img  class="logo-OIT" src="IMG/Logo_OIT.png" alt="">
        </a>
    </div>  
     <!-- Agregar el div del mapa -->
     <div class="contenedor-mapa" id="contenedor-mapa">
        <button id="btn-abrir-popup" class="btn-abrir-popup">↹</button>
         <div id="map"></div>
         <div class="overlay" id="overlay">
          <div class="popup-popup" id="popup-popup">
             <a href="#" id="btn-cerrar-popup" class="btn-cerrar-popup"><i class="x">X</i></a>
              <h3 class="h3">La cadena de valor del Algodón en la Argentina</h3>
              <h1 class="texto-info">
                La cadena algodonera-textil argentina, se compone de una fase primaria de producción de
                algodón y una fase industrial que se subdivide en tres segmentos: la producción de fibra, los
                manufacturados textiles - con sus tres productos: hilados, tejidos planos y tejidos de punto -
                y por último el segmento de confecciones e indumentaria. </h1>
                <h2 class="nivel-2">Etapas de la Producción de Algodón</h2>
                <img class="IMG-CPA" src="./IMG/Figura_LCDAlgodon.jpg"></img>
                <h3 class="nivel-3">La producción de Algodón en bruto</h3>
               <h1 class="texto-info">
               La fase primaria comprende el cultivo y la obtención del algodón en bruto o algodón con semilla. 
               En Argentina, la región algodonera se concentra principalmente entre los 25º y los 31º de latitud sur, con nuevas 
               áreas de siembra hacia el norte y el sur de dichas latitudes. Las provincias que generan la mayor 
               producción del país son: Santiago del Estero, Chaco, Santa Fe y Formosa, y en menor porcentaje Salta, 
               Corrientes, Catamarca, Córdoba, Entre Ríos y San Luis.</h1>
               <h1 class="texto-info">
               En la capa <p class="resaltar">densidad de lotes de algodón </p> se observa la distribución de lotes de algodón en las provincias de Santa Fe, 
               Santiago del Estero y Chaco, en un radio de 50 km. En la provincia de Santa Fe la cuenca algodonera 
               se divide en dos sectores: al este; los departamentos General Obligado, San Javier y Vera y al oeste; el 
               departamento de 9 de Julio, siendo este último el principal departamento en la producción de algodón de la provincia. 
               Por su parte, en Santiago del Estero se distinguen dos zonas productivas: al este la zona de secano  en donde 
               se encuentran grandes productores; que comprende los departamentos Alberdi, Moreno, Aguirre, Belgrano, General Taboada, 
               siendo en éstos donde se produce entre el 60 y el 70% del algodón de la provincia. En la zona oeste, se destaca la producción 
               </h1>

                <h1 class="texto-info">departamentos arrojan un riesgo promedio para Argentina a nivel departamental del 6,54%. Los departamentos
                con riesgo alto, mayor al 8,8%, son 51. En Argentina, según el modelo, el riesgo de trabajo infantil y adolescente es:
                i) creciente con la edad de niñas, niños y adolescentes (NNyA), ii) mayor en los varones, iii) aumenta para NNyA en
                hogares cuyo jefe es asalariado no registrado o es trabajador no asalariado en las zonas urbanas. Además, dentro de
                los factores de protección, se encuentran: i) el mayor nivel de escolaridad del jefe del hogar, ii) la asistencia a la escuela
                de NNyA y iii) la cobertura de salud paga para NNyA.
                departamentos arrojan un riesgo promedio para Argentina a nivel departamental del 6,54%. Los departamentos
                con riesgo alto, mayor al 8,8%, son 51. En Argentina, según el modelo, el riesgo de trabajo infantil y adolescente es:
                i) creciente con la edad de niñas, niños y adolescentes (NNyA), ii) mayor en los varones, iii) aumenta para NNyA en
                hogares cuyo jefe es asalariado no registrado o es trabajador no asalariado en las zonas urbanas. Además, dentro de
                los factores de protección, se encuentran: i) el mayor nivel de escolaridad del jefe del hogar, ii) la asistencia a la escuela
                de NNyA y iii) la cobertura de salud paga para NNyA.
                departamentos arrojan un riesgo promedio para Argentina a nivel departamental del 6,54%. Los departamentos
                con riesgo alto, mayor al 8,8%, son 51. En Argentina, según el modelo, el riesgo de trabajo infantil y adolescente es:
                i) creciente con la edad de niñas, niños y adolescentes (NNyA), ii) mayor en los varones, iii) aumenta para NNyA en
                hogares cuyo jefe es asalariado no registrado o es trabajador no asalariado en las zonas urbanas. Además, dentro de
                los factores de protección, se encuentran: i) el mayor nivel de escolaridad del jefe del hogar, ii) la asistencia a la escuela
                de NNyA y iii) la cobertura de salud paga para NNyA.
                departamentos arrojan un riesgo promedio para Argentina a nivel departamental del 6,54%. Los departamentos
                con riesgo alto, mayor al 8,8%, son 51. En Argentina, según el modelo, el riesgo de trabajo infantil y adolescente es:
                i) creciente con la edad de niñas, niños y adolescentes (NNyA), ii) mayor en los varones, iii) aumenta para NNyA en
                hogares cuyo jefe es asalariado no registrado o es trabajador no asalariado en las zonas urbanas. Además, dentro de
                los factores de protección, se encuentran: i) el mayor nivel de escolaridad del jefe del hogar, ii) la asistencia a la escuela
                de NNyA y iii) la cobertura de salud paga para NNyA.
                departamentos arrojan un riesgo promedio para Argentina a nivel departamental del 6,54%. Los departamentos
                con riesgo alto, mayor al 8,8%, son 51. En Argentina, según el modelo, el riesgo de trabajo infantil y adolescente es:
                i) creciente con la edad de niñas, niños y adolescentes (NNyA), ii) mayor en los varones, iii) aumenta para NNyA en
                hogares cuyo jefe es asalariado no registrado o es trabajador no asalariado en las zonas urbanas. Además, dentro de
                los factores de protección, se encuentran: i) el mayor nivel de escolaridad del jefe del hogar, ii) la asistencia a la escuela
                de NNyA y iii) la cobertura de salud paga para NNyA.
              </h1>
          </div>
        </div>
     </div>
    
     <!-- Añade el archivo JS -->
     <script src="js/OIT.js"></script> 
</body>
</html>